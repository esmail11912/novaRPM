<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>RPM 3-SAT Solver ‚Äì Step 7 (Conflict Explanation)</title>
  <style>
    body { font-family: Arial; background: #f7f7f7; padding: 20px; }
    textarea { width: 100%; height: 120px; font-size: 16px; font-family: monospace; }
    button { padding: 10px; margin: 10px 5px; font-weight: bold; }
    .section { background: white; padding: 15px; border-radius: 10px; margin-top: 20px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    .sat { background: #d4ffd4; padding: 10px; border-left: 5px solid green; margin-bottom: 10px; }
    .unsat { background: #ffd4d4; padding: 10px; border-left: 5px solid red; margin-bottom: 10px; }
    .result { font-size: 18px; font-weight: bold; padding: 10px; }
    .stable { color: green; }
    .unstable { color: red; }
    .mono { font-family: monospace; }
  </style>
</head>
<body>
  <h1>üîç RPM 3-SAT Solver ‚Äì Step 7</h1>
  <p>Enter your 3-SAT clauses (use numbers or variable form):</p>
  <textarea id="inputArea">(1 2 3)
(-1 -2 -3)
(1 -2 -3)
(-1 2 3)
(1 2 -3)
(-1 -2 3)</textarea><br>
  <button onclick="process()">Process</button>
  <div id="output" class="section"></div>

  <script>
    function process() {
      const raw = document.getElementById("inputArea").value.trim().split('\\n');
      const clauses = raw.map(line => line.replace(/[()]/g, '').trim().split(/\\s+/).map(Number));
      const varPressure = {}, values = {};

      // Initial pressure
      for (let c of clauses) {
        for (let l of c) {
          let v = Math.abs(l);
          if (!(v in varPressure)) varPressure[v] = 0;
          varPressure[v] += l > 0 ? 1 : -1;
        }
      }

      for (let v in varPressure) {
        values[v] = varPressure[v] > 0 ? 1 : varPressure[v] < 0 ? 0 : 0;
      }

      let result = '<div class="mono">Initial Pressures:<br>' + JSON.stringify(varPressure) + '</div>';
      let final = '<div class="mono">Final Assignments:<br>' + JSON.stringify(values) + '</div>';
      let status = '', satisfiable = true;

      for (let i = 0; i < clauses.length; i++) {
        const clause = clauses[i];
        let satisfied = false;
        let explain = '';
        for (let lit of clause) {
          const v = Math.abs(lit);
          const assigned = values[v];
          const litVal = lit > 0 ? assigned === 1 : assigned === 0;
          explain += `x${v}=${assigned} for ${lit > 0 ? 'x' + v : '¬¨x' + v} ‚Üí ${litVal ? '‚úîÔ∏è' : '‚ùå'}<br>`;
          if (litVal) satisfied = true;
        }
        const text = clause.map(x => (x > 0 ? `x${x}` : `¬¨x${-x}`)).join(' ‚à® ');
        if (satisfied) {
          status += `<div class="sat"><b>C${i+1}:</b> ${text} ‚úÖ</div>`;
        } else {
          satisfiable = false;
          status += `<div class="unsat"><b>C${i+1}:</b> ${text} ‚ùå<br>${explain}</div>`;
        }
      }

      let finalResult = satisfiable
        ? `<div class='result stable'>‚úÖ Result: SATISFIABLE</div>`
        : `<div class='result unstable'>‚ùå Result: UNSATISFIABLE (conflict detected)</div>`;

      document.getElementById('output').innerHTML = result + final + finalResult + status;
    }
  </script>
</body>
</html>
